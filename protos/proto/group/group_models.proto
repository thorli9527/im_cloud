syntax = "proto3";
package rpc_group_models;
import "common/common.proto"; // 引入全局定义
// ==============================
// 群组操作请求结构
// ==============================

/**
 * 创建群组请求
 */
message CreateGroupReq {
  string group_id = 1;          // 群组ID
}

/**
 * 解散群组请求
 */
message DestroyGroupReq {
  string group_id = 1;          // 群组ID
}

/**
 * 更新群组信息请求
 */
message UpdateGroupInfoReq {
  string id = 1;              // 群组ID
  string name = 2;                  // 群名称
  string avatar = 3;                // 群头像
  string description = 4;           // 群简介
  string notice = 5;                // 群公告
  string tags = 6;                  // 群标签（英文逗号分隔）
  common.JoinPermission join_permission = 7;        // 加群权限
  bool allow_search = 8;                     // 是否可被搜索
  common.GroupType group_type = 9;    // 群组类型

}


// ==============================
// 群组信息获取
// ==============================

/**
 * 获取群组信息请求
 */
message GetGroupInfoReq {
  string group_id = 1; // 群组ID
}

/**
 * 获取群组信息响应
 */
message GetGroupInfoRep {
  string group_id = 1;                     // 群组唯一ID（由系统生成）
  string name = 2;                   // 群组名称（用户可见）
  string avatar = 3;                 // 群头像URL
  string description = 4;            // 群简介（支持富文本）
  string notice = 5;                 // 群公告（群成员可见）
  common.JoinPermission join_permission = 6;        // 加群权限控制
  string owner_id = 7;                   // 群标签（英文逗号分隔）
  common.GroupType group_type = 8;                 // 群组类型
  bool allow_search = 9;                     // 是否允许通过搜索找到
}

// ==============================
// 群成员操作结构
// ==============================

/**
 * 添加成员请求
 */
message AddMemberReq {
  string group_id = 1;                  // 群ID
  repeated common.GroupMemberEntity members = 2;    // 成员信息
}

/**
 * 移除成员请求
 */
message RemoveMemberReq {
  string group_id = 1;         // 群ID
  repeated string uids = 2;    // 用户UID列表
}

/**
 * 用户主动退出群组请求
 */
message ExitGroupReq {
  string group_id = 1; // 群ID
  string uid = 2;      // 当前用户UID
}

/**
 * 更改群成员角色请求
 */
message ChangeMemberRoleReq {
  string group_id = 1;
  string uid = 2;
  common.GroupRoleType role = 3; // 新角色
}

/**
 * 禁言/取消禁言成员
 */
message MuteMemberReq {
  string group_id = 1;
  string uid = 2;
  bool status = 3; // true=禁言，false=取消禁言
}

/**
 * 修改成员别名请求
 */
message ChangeMemberAliasReq {
  string group_id = 1;
  string uid = 2;
  string alias = 3;
}

/**
 * 转让群主请求
 */
message TransferGroupOwnershipReq {
  string group_id = 1;
  string new_owner_uid = 2;
}

// ==============================
// 在线状态管理结构
// ==============================

/**
 * 用户上线请求
 */
message OnlineReq {
  string uid = 1;       // 用户ID
  string group_id = 2;  // 所属群组ID
}

/**
 * 用户离线请求
 */
message OfflineReq {
  string uid = 1;
  string group_id = 2;
}

// ==============================
// 群成员分页查询结构
// ==============================

/**
 * 获取在线成员请求（分页）
 */
message GetOnlineMembersReq {
  string group_id = 1; // 群ID
  int32 page = 2;      // 页码（从1开始）
  int32 page_size = 3; // 每页条数
}

/**
 * 获取在线成员响应
 */
message GetOnlineMembersResp {
  repeated string uids = 1;     // 在线UID列表
  int32 total_count = 2;        // 在线总人数
  bool success = 3;             // 是否成功
  string message = 4;     // 错误提示
}

/**
 * 获取所有成员请求（分页）
 */
message GetMembersReq {
  string group_id = 1;
  int32 page = 2;
  int32 page_size = 3;
}

/**
 * 获取所有成员响应
 */
message GetMembersRep {
  repeated string uids = 1;    // 成员UID列表
  int32 total_count = 2;       // 总人数
  bool success = 3;
  string message = 4;
}
